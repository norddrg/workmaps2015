Procedure seur_ero*push key clearselect analclose memo commentpb_comment=trim(comment)lc_drg=drglc_drg_ext=drg_extlc_oir1=oir1lc_oir2=oir2lc_syy1=syy1lc_syy2=syy2lc_tp1=tp1lc_tpo=drglogic.procpro1if not eof()	skipelse	wait window nowait 'You were at the end of the file - starting from the beginning'	goto topendifse_loop=.t.do while se_loop  Locate next 10000 for (drg)<>(drg_ext)   do luokitus  select anal  if val(drg)<>val(drg_ext) or len(trim(comment))>0    if val(drg)<>val(drg_ext) and (lc_drg=drg and lc_drg_ext=drg_ext and;    lc_oir1=oir1 and lc_syy1=syy1 and lc_tp1=tp1 and lc_oir2=oir2 and lc_syy2=syy2)       if len(trim(pb_comment))>0         replace comment with pb_comment         wait window 'Automatic replacement' timeout 1*         do analnayt         skip         loop       endif    endif    if (val(drg)<>val(drg_ext) and len(trim(comment))>0)       skip       loop    endif    exit  endif  if eof()    exit  endif  skip  loopenddodo analnaytreturn