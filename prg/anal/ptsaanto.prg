Procedure tpsaantodg_n=1dg_loop = .t.on key label pgdnon key label pgupdo while dg_loop  select drgtpt  set relation to koodi into ncsp_en  set relation to tpomin into tpomin additive  if dg_n=0    dg_n=9  endif  if dg_n=10    dg_n=1  endif  do case  case dg_n=1    seek anal.tp1  case dg_n=2    if anal.tp2=' '      dg_n=1      loop    endif    seek anal.tp2  case dg_n=3    if anal.tp3=' '      dg_n=1      loop    endif    seek anal.tp3  case dg_n=4    if anal.tp4=' '      dg_n=1      loop    endif    seek anal.tp4  case dg_n=5    if anal.tp5=' '      dg_n=1      loop    endif    seek anal.tp5  case dg_n=6    if anal.tp6=' '      dg_n=1      loop    endif    seek anal.tp6  case dg_n=7    if anal.tp7=' '      dg_n=1      loop    endif    seek anal.tp7  case dg_n=8    if anal.tp8=' '      dg_n=1      loop    endif    seek anal.tp8  case dg_n=9    if anal.tp9=' '      dg_n=1      loop    endif    seek anal.tp9  endcase  activate window anal  browse fields koodi, ncsp_en.nimike:50, tpomin, tpomin.name:50, or, kompl  if lastkey()=27    exit  endif  dg_n=dg_n+1enddoset relation torelease window drgnamedo analohjedo luokitusreturn