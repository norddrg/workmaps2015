procedure analsiirselect analset order to drgdo casecase p_kieli='E'  lc_siirto='\data\drg_n\siirto_2\eng'case p_kieli='D'  lc_siirto='\data\drg_n\siirto_d\dan'case p_kieli='F'  lc_siirto='\data\drg_n\siirto_f\fin'case p_kieli='N'  lc_siirto='\data\drg_n\siirto_n\nor'case p_kieli='S'   lc_siirto='\data\drg_n\siirto_s\swe'endcasereplace all gender with 1replace all gender with 2 for sex='F'replace all state with 0replace all state with 15 for lamareplace all state with 13 for deathreplace all state with 27 for remCOPY TO (lc_siirto+'.dbf') TYPE FOXPLUS FIELDS Anal.ika,Anal.sex,Anal.death,;Anal.lama,Anal.rem,Anal.oir1,Anal.syy1,Anal.oir2,Anal.syy2,Anal.oir3,Anal.syy3,;Anal.oir4,Anal.syy4,Anal.oir5,Anal.syy5,Anal.oir6,Anal.syy6,Anal.oir7,Anal.syy7,;Anal.oir8,Anal.syy8,Anal.oir9,Anal.syy9,Anal.tp1,Anal.tp2,Anal.tp3,Anal.tp4,;Anal.tp5,Anal.tp6,Anal.tp7,Anal.tp8,Anal.tp9,Anal.icd,Anal.mdc,Anal.dgkat,;Anal.pdgomin,Anal.dgomin,Anal.tpomin,Anal.kompkat,Anal.kompl,Anal.or,Anal.drg,;Anal.gender, Anal.stateCOPY TO (lc_siirto+'.xl2') TYPE XLS FIELDS Anal.ika,Anal.sex,Anal.death,;Anal.lama,Anal.rem,Anal.oir1,Anal.syy1,Anal.oir2,Anal.syy2,Anal.oir3,Anal.syy3,;Anal.oir4,Anal.syy4,Anal.oir5,Anal.syy5,Anal.oir6,Anal.syy6,Anal.oir7,Anal.syy7,;Anal.oir8,Anal.syy8,Anal.oir9,Anal.syy9,Anal.tp1,Anal.tp2,Anal.tp3,Anal.tp4,;Anal.tp5,Anal.tp6,Anal.tp7,Anal.tp8,Anal.tp9,Anal.icd,Anal.mdc,Anal.dgkat,;Anal.pdgomin,Anal.dgomin,Anal.tpomin,Anal.kompkat,Anal.kompl,Anal.or,Anal.drgselect 0use (lc_siirto)copy to (lc_siirto+'.txt') type delimited with char ,; FIELDS oir1,syy1,oir2,syy2,oir3,syy3,;oir4,syy4,tp1,tp2,tp3,tp4,;tp5,tp6,tp7,tp8,tp9,ika, gender, state,;sex,death,lama,rem,icd,mdc,dgkat,;pdgomin,dgomin,tpomin,kompkat,kompl,or,drguseselect analdo analnaytreturn